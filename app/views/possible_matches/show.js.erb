<% content_for :show do %>
(function(){
	var app = angular.module('GodsOfRiotry', ['ngRoute', 'ngAnimate']);

	app.controller('PossibleMatches', ['$scope', '$timeout', '$interval', '$sce', 
					   function($scope, $timeout, $interval, $sce){

					   	$scope.contemplated_piece = function(){
					   		this = new Array;

					   		this += {
						   			id: <%= @contemplated_piece.id %>, 
						   			image: <%= @contempalted_piece.image.picture %>,
						   			price: <%= @contemplated_piece.price %>,
						   			description: <%= @contemplated_piece.description %>
					   			}
					   	}();

					   	$scope.suggested_pieces = function(){
					   		this = new Array;

					   		for(i = 0; i < @suggested_pieces.length; i++){
					   			this += {
					   				id: <%= @suggested_pieces[i].id %>,
					   				image: <%= @suggested_pieces[i].image.picture %>,
					   				price: <%= @suggested_pieces[i].price %>,
					   				description: <%= @suggested_pieces[i].description %>
					   			}

					   		}
					   	}();


					   	var array = $scope.suggested_pieces;

					   	$timeout(function(){
					   		$scope.suggested_piece = array[array.length - 1];
					   	}, 100);

					   	var index = 0;

					   	$interval(function(){
					   		if(index > array.length - 1){
					   			index = 0;
					   		}
					   		$scope.suggested_piece = array[index];
					   		index++;
					   	}, 8000);

					   }]);

	app.animation('.possible_matches_suggested_pieces', ['$timeout', function($timeout){

		return {
			enter: function(element, done){

				var img = angular.element(element.children()[0]);
				var price = angular.element(element.children()[1]);
				var description = angular.element(element.children()[2]);

				img.css({
					opacity: 0
				});
				price.css({
					opacity: 0
				});
				description.css({
					opacity: 0
				});
				img.animate({
					opacity: 1
				}, 500, function(){
					img.on('mouseover', function(){
						price.css({opacity: 1});
						description.css({opacity: 1});
					}).off('mouseover', function(){
						price.css({opacity: 0});
						description.css({opacity: 0});
					});
				}());
			},

			leave: function(element, done){

				var img = angular.element(element.children()[0]);
				var price = angular.element(element.children()[1]);
				var description = angular.element(element.children()[2]);

				img.css({
					opacity: 1
				});

				img.animate({
					opacity: 0
				}, 500);
			}
		};
	}]);
})();
<%end%>

